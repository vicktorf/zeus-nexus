# Zeus Nexus Enhanced Deployment Manifests
# Complete deployment for the layered architecture

---
# Namespace
apiVersion: v1
kind: Namespace
metadata:
  name: ac-agentic
  labels:
    name: ac-agentic
    project: zeus-nexus

---
# RBAC Configuration
apiVersion: v1
kind: ServiceAccount
metadata:
  name: zeus-service-account
  namespace: ac-agentic

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: zeus-cluster-role
rules:
- apiGroups: [""]
  resources: ["pods", "services", "endpoints", "persistentvolumeclaims", "configmaps", "secrets"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets", "statefulsets"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
- apiGroups: ["extensions", "networking.k8s.io"]
  resources: ["ingresses", "networkpolicies"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: zeus-cluster-role-binding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: zeus-cluster-role
subjects:
- kind: ServiceAccount
  name: zeus-service-account
  namespace: ac-agentic

---
# Layer 1: Zeus Master Agent (Orchestrator)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: zeus-master
  namespace: ac-agentic
  labels:
    app: zeus-master
    layer: orchestrator
    component: master-agent
spec:
  replicas: 2
  selector:
    matchLabels:
      app: zeus-master
  template:
    metadata:
      labels:
        app: zeus-master
        layer: orchestrator
        component: master-agent
    spec:
      serviceAccountName: zeus-service-account
      containers:
      - name: zeus-master
        image: zeus-nexus/orchestrator:latest
        ports:
        - containerPort: 8000
        env:
        - name: REDIS_HOST
          value: "redis.ac-agentic.svc.cluster.local"
        - name: REDIS_PORT
          value: "6379"
        - name: POSTGRES_HOST
          value: "postgresql.ac-agentic.svc.cluster.local"
        - name: LOG_LEVEL
          value: "INFO"
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: zeus-master
  namespace: ac-agentic
  labels:
    app: zeus-master
    layer: orchestrator
spec:
  selector:
    app: zeus-master
  ports:
  - port: 8000
    targetPort: 8000
    name: http
  type: ClusterIP

---
# Layer 2: Satellite Agents

# Athena Agent (Project Management)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: athena
  namespace: ac-agentic
  labels:
    app: athena
    layer: satellite-agents
    agent-type: project-management
spec:
  replicas: 2
  selector:
    matchLabels:
      app: athena
  template:
    metadata:
      labels:
        app: athena
        layer: satellite-agents
        agent-type: project-management
    spec:
      serviceAccountName: zeus-service-account
      containers:
      - name: athena
        image: zeus-nexus/athena:latest
        ports:
        - containerPort: 8001
        env:
        - name: LLM_POOL_URL
          value: "http://llm-pool.ac-agentic.svc.cluster.local:8000"
        - name: JIRA_SERVICE_URL
          value: "http://jira-service.ac-agentic.svc.cluster.local:8002"
        - name: REDIS_URL
          value: "redis://redis.ac-agentic.svc.cluster.local:6379"
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8001
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /health
            port: 8001
          initialDelaySeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: athena
  namespace: ac-agentic
  labels:
    app: athena
    layer: satellite-agents
spec:
  selector:
    app: athena
  ports:
  - port: 8001
    targetPort: 8001
    name: http
  type: ClusterIP

---
# Hephaestus Agent (Cloud Architecture)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: hephaestus
  namespace: ac-agentic
  labels:
    app: hephaestus
    layer: satellite-agents
    agent-type: cloud-architecture
spec:
  replicas: 1
  selector:
    matchLabels:
      app: hephaestus
  template:
    metadata:
      labels:
        app: hephaestus
        layer: satellite-agents
        agent-type: cloud-architecture
    spec:
      serviceAccountName: zeus-service-account
      containers:
      - name: hephaestus
        image: zeus-nexus/hephaestus:latest
        ports:
        - containerPort: 8002
        env:
        - name: LLM_POOL_URL
          value: "http://llm-pool.ac-agentic.svc.cluster.local:8000"
        - name: OPENSHIFT_SERVICE_URL
          value: "http://openshift-service.ac-agentic.svc.cluster.local:8002"
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8002
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /health
            port: 8002
          initialDelaySeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: hephaestus
  namespace: ac-agentic
  labels:
    app: hephaestus
    layer: satellite-agents
spec:
  selector:
    app: hephaestus
  ports:
  - port: 8002
    targetPort: 8002
    name: http
  type: ClusterIP

---
# Apollo Agent (Business Consultant)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: apollo
  namespace: ac-agentic
  labels:
    app: apollo
    layer: satellite-agents
    agent-type: business-consultant
spec:
  replicas: 1
  selector:
    matchLabels:
      app: apollo
  template:
    metadata:
      labels:
        app: apollo
        layer: satellite-agents
        agent-type: business-consultant
    spec:
      serviceAccountName: zeus-service-account
      containers:
      - name: apollo
        image: zeus-nexus/apollo:latest
        ports:
        - containerPort: 8003
        env:
        - name: LLM_POOL_URL
          value: "http://llm-pool.ac-agentic.svc.cluster.local:8000"
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8003
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /health
            port: 8003
          initialDelaySeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: apollo
  namespace: ac-agentic
  labels:
    app: apollo
    layer: satellite-agents
spec:
  selector:
    app: apollo
  ports:
  - port: 8003
    targetPort: 8003
    name: http
  type: ClusterIP

---
# Layer 4: LLM Pool Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: llm-pool
  namespace: ac-agentic
  labels:
    app: llm-pool
    layer: llm-pool
    component: multi-llm-router
spec:
  replicas: 2
  selector:
    matchLabels:
      app: llm-pool
  template:
    metadata:
      labels:
        app: llm-pool
        layer: llm-pool
        component: multi-llm-router
    spec:
      serviceAccountName: zeus-service-account
      containers:
      - name: llm-pool
        image: zeus-nexus/llm-pool:latest
        ports:
        - containerPort: 8000
        env:
        - name: OPENAI_API_KEY
          valueFrom:
            secretKeyRef:
              name: zeus-secrets
              key: openai-api-key
              optional: true
        - name: ANTHROPIC_API_KEY
          valueFrom:
            secretKeyRef:
              name: zeus-secrets
              key: anthropic-api-key
              optional: true
        - name: LOCAL_LLM_ENDPOINT
          value: "http://ollama.ac-agentic.svc.cluster.local:11434"
        - name: REDIS_URL
          value: "redis://redis.ac-agentic.svc.cluster.local:6379"
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: llm-pool
  namespace: ac-agentic
  labels:
    app: llm-pool
    layer: llm-pool
spec:
  selector:
    app: llm-pool
  ports:
  - port: 8000
    targetPort: 8000
    name: http
  type: ClusterIP

---
# Layer 3: ToolHub Services

# Jira Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: jira-service
  namespace: ac-agentic
  labels:
    app: jira-service
    layer: toolhub-services
    service-type: integration
spec:
  replicas: 1
  selector:
    matchLabels:
      app: jira-service
  template:
    metadata:
      labels:
        app: jira-service
        layer: toolhub-services
        service-type: integration
    spec:
      serviceAccountName: zeus-service-account
      containers:
      - name: jira-service
        image: zeus-nexus/jira-service:latest
        ports:
        - containerPort: 8002
        env:
        - name: JIRA_SERVER
          valueFrom:
            secretKeyRef:
              name: zeus-secrets
              key: jira-server
              optional: true
        - name: JIRA_EMAIL
          valueFrom:
            secretKeyRef:
              name: zeus-secrets
              key: jira-email
              optional: true
        - name: JIRA_API_TOKEN
          valueFrom:
            secretKeyRef:
              name: zeus-secrets
              key: jira-api-token
              optional: true
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8002
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /health
            port: 8002
          initialDelaySeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: jira-service
  namespace: ac-agentic
  labels:
    app: jira-service
    layer: toolhub-services
spec:
  selector:
    app: jira-service
  ports:
  - port: 8002
    targetPort: 8002
    name: http
  type: ClusterIP

---
# OpenShift Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: openshift-service
  namespace: ac-agentic
  labels:
    app: openshift-service
    layer: toolhub-services
    service-type: platform
spec:
  replicas: 1
  selector:
    matchLabels:
      app: openshift-service
  template:
    metadata:
      labels:
        app: openshift-service
        layer: toolhub-services
        service-type: platform
    spec:
      serviceAccountName: zeus-service-account
      containers:
      - name: openshift-service
        image: zeus-nexus/openshift-service:latest
        ports:
        - containerPort: 8002
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8002
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /health
            port: 8002
          initialDelaySeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: openshift-service
  namespace: ac-agentic
  labels:
    app: openshift-service
    layer: toolhub-services
spec:
  selector:
    app: openshift-service
  ports:
  - port: 8002
    targetPort: 8002
    name: http
  type: ClusterIP